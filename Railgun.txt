ACTOR RailGun : BrutalWeapon
{
	Weapon.AmmoUse1 0
	Weapon.AmmoUse2 0
	Weapon.AmmoGive1 20
	Weapon.AmmoGive2 0
	Weapon.AmmoType1 "AmmoCell"
	Weapon.AmmoType2 "RailgunAmmo"
	Obituary "%o was pierced by %k's Railgun."
    Inventory.PickupSound "Railgun/Recharge"
	Inventory.Pickupmessage "$GOTRG"
	+WEAPON.NOAUTOAIM
	+WEAPON.NOAUTOFIRE
	+WEAPON.EXPLOSIVE
	+WEAPON.NOALERT
	damagetype "Railgun"
	Weapon.SelectionOrder 200
	Scale 0.8
	DropItem "RailgunSpawner"
	States
	{
	KickFlash://18 tics
		TNT1 A 0
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto KickFlashNoAmmo
		TNT1 AAA 0
		RAIS DEF 1
		RAIS F 15
		RAIS FED 1
		Stop

	KickFlashNoAmmo:
		RAIS JKL 1
		RAIS L 15
		RAIS LKJ 1
		Stop

	SlideFlashEnd://10 tics
		TNT1 A 0
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto SlideFlashEndNoAmmo
		TNT1 AAA 0
		RAIS F 10
		RAIS FED 1
		Stop

	SlideFlashEndNoAmmo:
		RAIS L 10
		RAIS LKJ 1
		Stop

	Deselect:
		RAIL A 0
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
		RAIL A 0 A_Takeinventory("Zoomed",1)
		TNT1 A 0 A_TakeInventory("StartDualWield",1)
        RAIL A 0 A_ZoomFactor(1.0)
		RAIL A 0 A_SetCrosshair(0)
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto DeselectNoAmmo
		TNT1 AAA 0
        RAIS DEF 1 BRIGHT
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_Lower
		TNT1 A 1 A_Lower
		Wait

	DeselectNoAmmo:
        RAIS JKL 1 BRIGHT
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_Lower
		TNT1 A 1 A_Lower
		Wait

	Select:
		RAIL A 0 A_Giveinventory("GoSpecial",1)
		TNT1 A 0 A_TakeInventory("FistsSelected", 1)
		TNT1 A 0 A_TakeInventory("ShotgunSelected", 1)
		TNT1 A 0 A_TakeInventory("MinigunSelected", 1)
		TNT1 A 0 A_TakeInventory("SSGSelected", 1)
		TNT1 A 0 A_TakeInventory("RocketLauncherSelected", 1)
		TNT1 A 0 A_TakeInventory("GrenadeLauncherSelected", 1)
		TNT1 A 0 A_TakeInventory("PlasmaGunSelected", 1)
		TNT1 A 0 A_GiveInventory("RailGunSelected", 1)
		TNT1 A 0 A_TakeInventory("RevenantLauncherSelected", 1)
		TNT1 A 0 A_TakeInventory("SubMachineGunSelected", 1)
		TNT1 A 0 A_TakeInventory("BFG10KSelected", 1)
		TNT1 A 0 A_TakeInventory("BFGSelected", 1)
		TNT1 A 0 A_TakeInventory("FlameCannonSelected", 1)
		TNT1 A 0 A_TakeInventory("SawSelected", 1)
		RAIL A 0 A_Takeinventory("HasBarrel",1)
		TNT1 A 0 A_TakeInventory("StartDualWield",1)
		RAIL A 0 A_GunFlash
		TNT1 A 1 A_Raise
		TNT1 AAAAAAAAAAAA 0 A_Raise
		Goto SelectAnimation

	SelectAnimation:
		TNT1 A 0
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto SelectAnimationNoAmmo
		TNT1 AAA 0
		RAIS CBA 1 BRIGHT A_JumpIfInventory("GoFatality", 1, "Steady")
        RIFG A 0 A_PlaySound("Railgun/Recharge", 5)
		RLNG A 0 A_JumpIfInventory("Reloading",1,"Reload")
		Goto Ready3

	SelectAnimationNoAmmo:
		RAIS IHG 1 BRIGHT A_JumpIfInventory("GoFatality", 1, "Steady")
        RIFG A 0 A_PlaySound("Railgun/Recharge", 5)
		RLNG A 0 A_JumpIfInventory("Reloading",1,"Reload")
		Goto Ready3

	Ready3:
	Ready:
		TNT1 A 0
		RAIL A 0 A_JumpIfInventory("RGUnloaded",1,"ReadyUnloaded")
		RAIL A 0 A_JumpIfInventory("Zoomed",1,"Ready2")
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto ReadyNoAmmo
		RAIL ABC 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
        RAIL A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        RAIL A 0 A_JumpIfInventory("Taunting",1,"GoTaunt")
		RAIL A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Salute2", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Reloading",1,"Reload")
		RAIL A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		TNT1 A 0 A_JumpIfInventory("ExecuteDownedEnemy", 1, "DoExecution")
		RAIL A 0 A_JumpIfInventory("IsRunning",1,"StartSprint")
		RAIL A 0 A_JumpIfInventory("Unloading",1,"Unload")
		RAIL A 0 A_JumpIfInventory("Zoomed",1,"Ready2")
		RLNG A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		Loop

	Ready2:
		TNT1 A 0
		RIFG A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto ReadyNoAmmo
		SNIP A 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("Unloading",1,"Unload")
		RAIL A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        RAIL A 0 A_JumpIfInventory("Taunting",1,"GoTaunt")
		RAIL A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Salute2", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Reloading",1,"Reload")
		RAIL A 0 A_JumpIfInventory("IsRunning",1,"StartSprint")
		RAIL A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		TNT1 A 0 A_JumpIfInventory("ExecuteDownedEnemy", 1, "DoExecution")
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		Loop

	ReadyNoAmmo:
		TNT1 A 0
		RIFG A 0 A_ZoomFactor(1.0)
		RIFG A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
		RAIL A 0 A_SetCrosshair(0)
	    RAIR B 1 A_WeaponReady(WRF_ALLOWRELOAD)
		TNT1 A 0 A_JumpIfInventory("ExecuteDownedEnemy", 1, "DoExecution")
		RLNG A 0 A_JumpIfInventory("Unloading",1,"Unload")
        RLNG A 0 A_JumpIfInventory("Reloading",1,"Reload")
        RLNG A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RLNG A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RLNG A 0 A_JumpIfInventory("Salute2", 1, "Salute")
        RLNG A 0 A_JumpIfInventory("Taunting",1,"Taunt")
		RLNG A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		RLNG A 0 A_JumpIfInventory("IsRunning",1,"StartSprintNoAmmo")
		Loop

	NoAmmo:
		TNT1 A 0
		RIFG A 0 A_ZoomFactor(1.0)
		RIFG A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
		RIFG A 0 A_Takeinventory("ADSmode",1)
		RAIL A 0 A_SetCrosshair(0)
		RIFG A 0 A_JumpIfInventory("TurboReload",1,"InsertBullets")
		TNT1 A 0 A_PlaySound("weapons/empty", 4)
		RAIL A 0 A_JumpIfInventory("RGUnloaded", 1, "NoAmmo3")
	NoAmmo2:
		RAIL A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        RAIL A 0 A_JumpIfInventory("Taunting",1,"GoTaunt")
		RAIL A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Salute2", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		RAIR B 5 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RIFG A 0 A_JumpIfInventory("Reloading",1,"Reload")
		RIFG A 0 A_JumpIfInventory("TurboReload",1,"InsertBullets")
		TNT1 A 0 A_JumpIfInventory("NoAutoReload", 1, 2)
		RIFG A 0 A_JumpIfInventory("AmmoCell",1,"Reload")
		RAIL A 0 A_JumpIfInventory("IsRunning",1,"StartSprintNoAmmo")
		Goto Ready
	NoAmmo3:
		RAIL A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        RAIL A 0 A_JumpIfInventory("Taunting",1,"GoTaunt")
		RAIL A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Salute2", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		RAIR L 5 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RIFG A 0 A_JumpIfInventory("Reloading",1,"Reload")
		RIFG A 0 A_JumpIfInventory("TurboReload",1,"InsertBullets")
		TNT1 A 0 A_JumpIfInventory("NoAutoReload", 1, 2)
		RIFG A 0 A_JumpIfInventory("AmmoCell",1,"Reload")
		RAIL A 0 A_JumpIfInventory("IsRunning",1,"StartSprintNoAmmo")
		Goto ReadyUnloaded

	ReadyUnloaded:
		TNT1 A 0
		RAIR L 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		TNT1 A 0 A_JumpIfInventory("ExecuteDownedEnemy", 1, "DoExecution")
		RAIL A 0 A_JumpIfInventory("IsRunning",1,"StartSprintNoAmmo")
		RAIL A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        RAIL A 0 A_JumpIfInventory("Taunting",1,"GoTaunt")
		RAIL A 0 A_JumpIfInventory("Salute1", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Salute2", 1, "Salute")
		RAIL A 0 A_JumpIfInventory("Unloading",1,"Unload")
		RAIL A 0 A_JumpIfInventory("Reloading",1,"Reload")
		RAIL A 0 A_JumpIfInventory("TossGrenade",1,"TossGrenade")
		Loop

	Fire:
	    RAIL A 0
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto NoAmmo
		TNT1 AAA 0
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",10,1)
		Goto Ready
		TNT1 AAA 0
		RAIL A 0 A_JumpIfInventory("Pumping",1,"Ready")//Wait for recharge
		TNT1 AAA 0
		RAIL A 0 A_Takeinventory("RailgunAmmo",10)
		TNT1 A 0 A_FireCustomMissile("Alerter",0,0)
		RAIL A 0 A_SpawnItemEx("PlasmaFlareSpawn",32,0,28)
		RAIL A 0 A_FireCustomMissile("RailgunProjectile", 0, 1, 0, 0)
		RAIL A 0 A_RailAttack(400, 0, 0, "none", "none", RGF_FULLBRIGHT, 0, "RailgunPuff2", 0, 0, 0, 0, 0, 0, "RailgunTrailEffect", -4)

		RAIL A 0 A_PlaySound("Railgun/Fire", 1)

		RAIL A 0 A_JumpIfInventory("Zoomed",1,"ZoomedRecoil")

		RIFG A 0 A_JumpIfInventory("IsNOTTacticalClass", 1, 2)//tactical mode has muzzle climb
		RIFG A 0 A_SetPitch(-2.0 + pitch)
		RAIL A 0 A_SetPitch(-2.0 + pitch)

        RAIF A 1 BRIGHT A_AlertMonsters
		TNT1 A 0 A_Recoil(2)
		TNT1 A 0 A_ZoomFactor(0.96)
		RAIF B 1 BRIGHT A_SetPitch(0.25 + pitch)
		TNT1 A 0 A_FireCustomMissile("SmokeSpawner",0,0,0,5)
		TNT1 A 0 A_ZoomFactor(1.0)
		RAIF CDEFG 1 BRIGHT A_SetPitch(0.25 + pitch)
		RAIL DD 1 BRIGHT A_SetPitch(0.25 + pitch)
		RAIL A 0 A_PlaySound("Railgun/Recharge", 5)
		RAIL A 0 A_GiveInventory("Pumping",1)
		RAIL A 0 ACS_NamedExecuteAlways("RailgunRecharge",0,0,0,0)
		RAIL DDDDDDDDDDDDDDDDDDDDD 2 BRIGHT A_WeaponReady(WRF_NOPRIMARY | WRF_NOBOB | WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		Goto Ready3

	ZoomedRecoil:
		RIFG A 0
		RIFG A 0 A_JumpIfInventory("IsNOTTacticalClass", 1, 2)//tactical mode has muzzle climb
		RIFG A 0 A_SetPitch(-1.0 + pitch)
		RAIL A 0 A_SetPitch(-1.0 + pitch)

		SNIP A 1 BRIGHT A_AlertMonsters
		TNT1 A 0 A_Recoil(1)
		TNT1 A 0 A_ZoomFactor(4.98)
		SNIP A 1 BRIGHT A_SetPitch(0.125 + pitch)
		TNT1 A 0 A_FireCustomMissile("SmokeSpawner",0,0,0,5)
		TNT1 A 0 A_ZoomFactor(5.0)
		SNIP AAAAAAA 1 BRIGHT A_SetPitch(0.125 + pitch)
		RAIL A 0 A_PlaySound("Railgun/Recharge", 5)
		RAIL A 0 A_GiveInventory("Pumping",1)
		RAIL A 0 ACS_NamedExecuteAlways("RailgunRecharge",0,0,0,0)
		SNIP AAAAAAAAAAAAAAAAAAAAA 2 BRIGHT A_WeaponReady(WRF_NOPRIMARY | WRF_NOBOB | WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpifInventory("FiredSecondary", 1, "HoldAim")
		SNIP A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		Goto Ready2

    AltFire:
        RAIL A 0
		RAIL A 0 A_JumpIfInventory("Zoomed",1,"NoAim")
		RAIL A 0 A_Giveinventory("Zoomed",1)
        RAIL A 0 A_ZoomFactor(5.0)
		RAIL A 0 A_giveinventory("PowerLightAmp", 1)
		RAIL A 0 A_SetCrosshair(41)
		TNT1 A 0 A_PlaySound("ads/in", 5)
        RAIZ AB 2 BRIGHT

        RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT
		RAIL A 0 A_JumpIfInventory("FiredSecondary",1,"HoldAim")
        Goto Ready2

	   HoldAim:
	    RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		SNIP A 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		RAIL A 0 A_JumpIfInventory("FiredSecondary",1,"HoldAim")

	 NoAim:
        RAIZ BA 2 BRIGHT
		RAIL A 0 A_Light0
		RAIL A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
        RAIL A 0 A_ZoomFactor(1.0)
		RAIL A 0 A_SetCrosshair(0)
		TNT1 A 0 A_PlaySound("ads/out", 5)
        Goto Ready

      Reload:
	    RAIL A 0
        A12G A 0 A_Takeinventory("Reloading",1)
		A12G A 0 A_Takeinventory("ADSmode",1)
		A12G A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
		RAIL A 0 A_ZoomFactor(1.0)
		RAIL A 0 A_SetCrosshair(0)
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",50,"Ready")
        RAIL A 0 A_JumpIfInventory("AmmoCell",1,1)
        Goto Ready
        TNT1 AAA 0
		RAIL A 0 A_JumpIfInventory("RGUnloaded",1, "PutMag")
		RAIL A 0 A_JumpIfInventory("TurboReload", 1, "InsertBullets")
		RAIR ABCDE 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIR F 4 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIL A 0 A_PlaySound("Plasma/Reload1", 5)
		RAIR GHIJK 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIR L 8 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIL A 0 A_GiveInventory("RGUnloaded",1)
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",1,"PutMag")//Retain mag if not empty
		RAIL A 0 A_FireCustomMissile("EmptyCellSpawn",225,0,-10,-20)

	PutMag:
		RAIR L 8 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		A12G A 0 A_Takeinventory("Reloading",1)
		A12G A 0 A_Takeinventory("ADSmode",1)
		A12G A 0 A_Takeinventory("Zoomed",1)
		RAIR MNOPQR 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		A12G A 0 A_Takeinventory("RGUnloaded",1)
		RAIL A 0 A_PlaySound("Plasma/Reload2")
		RAIL A 0 A_GiveInventory("Pumping",1)
		RAIR STU 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIR V 4 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIL A 0 ACS_NamedExecuteAlways("RailgunRecharge",0,0,0,0)
		RAIL A 0 A_PlaySound("Railgun/Recharge", 5)
		RAIR WX 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")

	InsertBullets:
		TNT1 A 0
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",50,"DontNeedToReload")//turboreload
		RAIL A 0 A_JumpIfInventory("AmmoCell",1,1)
		Goto Ready
        TNT1 AAA 0
		RAIL A 0 A_Takeinventory("RGUnloaded", 1)
		RAIL A 0 A_Giveinventory("RailgunAmmo",1)
		RAIL A 0 A_Takeinventory("AmmoCell",1)
		Goto InsertBullets

	DontNeedToReload:
		RAIL A 1 A_Takeinventory("Reloading",1)
        RAIL A 0 A_JumpIfInventory("FiredPrimary",1,"Fire")
		Goto Ready

	Unload:
	    RAIL A 0
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
        A12G A 0 A_Takeinventory("Unloading",1)
		A12G A 0 A_Takeinventory("ADSmode",1)
		A12G A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_ZoomFactor(1.0)
		RAIL A 0 A_SetCrosshair(0)
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto Ready
        TNT1 AAA 0
		RAIR ABCDE 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIR F 4 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIL A 0 A_PlaySound("Plasma/Reload1", 5)
		RAIR GHIJK 1 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIR L 8 BRIGHT A_WeaponReady(WRF_NOBOB | WRF_NOFIRE)
		A12R A 0 A_JumpIfInventory("Kicking",1,"DoKick")
		RAIL A 0 A_GiveInventory("RGUnloaded",1)

	RemoveBullets:
		TNT1 A 0
		RAIL A 0 A_JumpIfInventory("RailgunAmmo",1,1)
		Goto ReadyUnloaded
        TNT1 AAA 0
		RAIL A 0 A_Takeinventory("RailgunAmmo",1)
		RAIL A 0 A_Giveinventory("AmmoCell",1)
		Loop

 	Spawn:
		SRCG A -1
		Stop

	StartSprint:
		RAIS DEF 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		SHTN A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
        SHTN A 0 A_ZoomFactor(1.0)
		SHTN A 0 A_Takeinventory("ADSmode",1)
		RIFG A 0 A_SetCrosshair(0)
		SHTN A 0 A_Giveinventory("GoSpecial",1)
		TNT1 A 0 ACS_NamedExecuteAlways("BDSprint", 0, 0, 0, 0)//Makes player faster.
		Goto Sprinting

	Sprinting:
		RAIS F 1 BRIGHT offset(-9,34) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(-6,36) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(-3,38) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(0,38) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(3,36) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(6,34) A_SetPitch(pitch -0.5)
		RAIS F 1 BRIGHT offset(9,32) A_SetPitch(pitch -0.5)
		TNT1 A 0 A_GiveInventory("UsedStamina", 2)
		SMGG A 0 A_WeaponReady(WRF_NOBOB)
		SMGG A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        SMGG A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        SMGG A 0 A_JumpIfInventory("Reloading",1,"Reload")

		RAIS F 1 BRIGHT offset(9,34) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(6,36) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(3,38) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(0,38) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(-3,36) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(-6,34) A_SetPitch(pitch +0.5)
		RAIS F 1 BRIGHT offset(-9,32) A_SetPitch(pitch +0.5)
		TNT1 A 0 A_GiveInventory("UsedStamina", 2)
		SMGG A 0 A_WeaponReady(WRF_NOBOB)
		SMGG A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        SMGG A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        SMGG A 0 A_JumpIfInventory("Reloading",1,"Reload")

		PLAY A 0 ACS_NamedExecuteAlways("BDSprint", 0, 0, 0, 0)//Makes player faster.
		SMGG A 0 A_JumpIfInventory("IsRunning", 1, "Sprinting")
		Goto StopSprint

	StopSprint:
		RAIS FED 1 BRIGHT
		RAIL A 0 A_JumpIfInventory("PowerStrength", 1, 2)
		RAIL A 0 A_JumpIfInventory("UsedStamina", 100, "StopSprintTired")
		RAIL A 0 ACS_NamedExecuteAlways("BDTacticalSpeed", 0, 0, 0, 0)//Makes player slower.
		Goto Ready3

	StopSprintTired:
		RAIL A 0 ACS_NamedExecuteAlways("BDTacticalSpeed", 0, 0, 0, 0)//Makes player slower.
		RAIL A 0 A_PlaySound("Tired", 2)
		Goto Ready3

	StartSprintNoAmmo:
		RAIS JKL 1 BRIGHT A_WeaponReady(WRF_ALLOWRELOAD)
		SHTN A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
        SHTN A 0 A_ZoomFactor(1.0)
		SHTN A 0 A_Takeinventory("ADSmode",1)
		RIFG A 0 A_SetCrosshair(0)
		SHTN A 0 A_Giveinventory("GoSpecial",1)
		TNT1 A 0 ACS_NamedExecuteAlways("BDSprint", 0, 0, 0, 0)//Makes player faster.
		Goto SprintingNoAmmo

	SprintingNoAmmo:
		RAIS L 1 BRIGHT offset(-9,34) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(-6,36) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(-3,38) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(0,38) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(3,36) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(6,34) A_SetPitch(pitch -0.5)
		RAIS L 1 BRIGHT offset(9,32) A_SetPitch(pitch -0.5)
		TNT1 A 0 A_GiveInventory("UsedStamina", 2)
		SMGG A 0 A_WeaponReady(WRF_NOBOB)
		SMGG A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        SMGG A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        SMGG A 0 A_JumpIfInventory("Reloading",1,"Reload")

		RAIS L 1 BRIGHT offset(9,34) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(6,36) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(3,38) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(0,38) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(-3,36) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(-6,34) A_SetPitch(pitch +0.5)
		RAIS L 1 BRIGHT offset(-9,32) A_SetPitch(pitch +0.5)
		TNT1 A 0 A_GiveInventory("UsedStamina", 2)
		SMGG A 0 A_WeaponReady(WRF_NOBOB)
		SMGG A 0 A_JumpIfInventory("Kicking",1,"DoKick")
        SMGG A 0 A_JumpIfInventory("Taunting",1,"Taunt")
        SMGG A 0 A_JumpIfInventory("Reloading",1,"Reload")

		PLAY A 0 ACS_NamedExecuteAlways("BDSprint", 0, 0, 0, 0)//Makes player faster.
		SMGG A 0 A_JumpIfInventory("IsRunning", 1, "SprintingNoAmmo")
		Goto StopSprintNoAmmo

	StopSprintNoAmmo:
		RAIS LKJ 1 BRIGHT
		RAIR B 0 A_JumpIfInventory("PowerStrength", 1, 2)
		RAIL A 0 A_JumpIfInventory("UsedStamina", 100, "StopSprintTiredNoAmmo")
		RAIR B 0 ACS_NamedExecuteAlways("BDTacticalSpeed", 0, 0, 0, 0)//Makes player slower.
		Goto ReadyNoAmmo

	StopSprintTiredNoAmmo:
		RAIR B 0 ACS_NamedExecuteAlways("BDTacticalSpeed", 0, 0, 0, 0)//Makes player slower.
		RAIL A 0 A_PlaySound("Tired", 2)
		Goto ReadyNoAmmo

	GoTaunt:
		RAIL A 0
		RAIL A 0 A_Light0
		RAIL A 0 A_Takeinventory("Zoomed",1)
		RAIL A 0 A_Takeinventory("PowerLightAmp", 1)
        RAIL A 0 A_ZoomFactor(1.0)
		RAIL A 0 A_SetCrosshair(0)
		Goto Taunt
	}
}

ACTOR RailgunProjectile
{
	Radius 2
	Height 4
	Speed 256
	Damage (random(400, 400))
    DamageType Railgun
	Decal "Scorch"
	Projectile
	+RANDOMIZE
	+MISSILE
	+THRUSPECIES
	+FORCERADIUSDMG
	+BounceOnWalls
	+BounceOnFloors
	+BounceOnCeilings
	+ROCKETTRAIL
	+RIPPER
	Species "Marines"
	DeathSound "weapons/plasmax"
    SeeSound "None"
	Obituary "$OB_MPPLASMARIFLE"
	BounceFactor 1.0
	BounceCount 2
	States
	{
	Spawn:
        TNT1 A 1 BRIGHT
		RAIL A 0 A_SpawnItem("WhiteShockwave")
		RAIL A 0 A_CheckFloor("Death")
		Loop

	Melee:
	Death:
	XDeath:
		TNT1 A 1
		TNT1 AA 0 A_CustomMissile ("SparkXNoModel", 2, 0, random (0, 360), 2, random (0, 360))
		RAIL A 0 A_SpawnItem("RailgunFlameTrails")

		TNT1 AAA 0 A_CustomMissile ("BDExplosionparticles", 0, 0, random (0, 360), 2, random (40, 90))
		TNT1 AA 0 A_CustomMissile ("BDExplosionparticles2", 0, 0, random (0, 360), 2, random (40, 90))
		TNT1 AA 0 A_CustomMissile ("BDExplosionparticles3", 10, 0, random (0, 360), 2, random (40, 90))
		TNT1 AAA 0 A_CustomMissile ("ExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))

		RAIL A 0 A_SpawnItemEx ("DetectFloorCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("DetectCeilCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("RocketExplosion",0,0,13,0,0,0,0,SXF_NOCHECKPOSITION,0)
		EXPL A 0 Radius_Quake (1, 7, 0, 1, 0)
		RAIL A 0 A_SpawnItemEx ("UnderwaterExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("LiquidExplosionEffectSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 2
		RAIL A 0 A_PlaySound("FAREXPL", 0)
		TNT1 A 15
		RAIL A 0 A_PlaySound("distexpl", 5)
		Stop
	}
}

actor RailgunTracerTrail
{
    Scale 0.3
    RenderStyle Add
    Alpha 0.9
    +NOINTERACTION
    +CLIENTSIDEONLY
	+FORCEXYBILLBOARD
    States
    {
    Spawn:
        PBAL AB 1 BRIGHT
        stop
    }
}

Actor RailgunPenetrationParticle
{
+THRUACTORS
+CLIENTSIDEONLY
+MISSILE
+NOGRAVITY
+ROCKETTRAIL
States
	{
	Spawn:
		TNT1 A 15
		Stop
	}
}

Actor RailgunTrailEffect
{
+THRUACTORS
+CLIENTSIDEONLY
+MISSILE
+NOGRAVITY
RenderStyle Add
Alpha 1.0
Scale 0.1
States
	{
	Spawn:
		PBEX ABCD 1 BRIGHT A_FadeOut(0.125)
		Loop
	}
}

Actor RailgunPenetrator: MarineTracer
{
	damage (random(50, 60))
	Decal "Scorch"
	DamageType Railgun
	Radius 4
	Height 4
	Scale 0.2
	+MISSILE
	+RIPPER
	Speed 600
	-SKYEXPLODE
	MissileType "RailgunPenetrationParticle"
	States
	{
	Spawn:
		TNT1 A 10 A_CustomMissile("SpawnBulletDecalBackwards", 0, 0, 0)
		Stop

	Death:
	XDeath:
		RAIL A 0 A_SpawnItemEx ("DetectFloorCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("DetectCeilCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("UnderwaterExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 180))
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 360))
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleVeryFast", 0, 0, random (0, 360), 2, random (0, 360))
		EXPL AAAAA 0 A_CustomMissile ("ExplosionSmokeFast22", 0, 0, random (0, 360), 2, random (0, 360))
		TNT1 A 0 A_Explode(50, 100)
		RAIL A 0 A_SpawnItemEx ("DetectFloorCraterSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_SpawnItemEx ("DetectCeilCraterSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		RAIL A 0 A_CustomMissile ("BluePlasmaFire", 0, 0, random (0, 360), 2, random (0, 360))
		TNT1 AAAAA 0 A_CustomMissile ("BluePlasmaParticle", 0, 0, random (0, 360), 2, random (0, 360))
		TNT2 AAAAAAAAA 9 A_CustomMissile ("PlasmaSmoke", 1, 0, random (0, 360), 2, random (0, 160))
		Stop
	}
}

ACTOR RailgunAmmo : Ammo
{
   Inventory.Amount 0
   Inventory.MaxAmount 50
   Ammo.BackpackAmount 0
   Inventory.Icon "SRCGA0"
   Ammo.BackpackMaxAmount 50
}
